<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JavaScript DOM</title>
    <link
      href="../assets/vendor/bootstrap/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="../assets/vendor/bootstrap-icons/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link href="../assets/css/main.css" rel="stylesheet" />
    <link href="../assets/css/blog.css" rel="stylesheet" />
    <link href="../assets/css/rating-comments.css" rel="stylesheet" />
  </head>
  <body class="blog-page">
    <header
      id="header"
      class="header d-flex align-items-center light-background sticky-top"
    >
      <div
        class="container position-relative d-flex align-items-center justify-content-between"
      >
        <nav id="navmenu" class="navmenu">
          <ul>
            <li><a href="../index.html">Trang Chủ</a></li>
            <li><a href="../about.html">Giới Thiệu</a></li>
            <li><a href="../resume.html">Hồ Sơ</a></li>
            <li><a href="../portfolio.html">Dự Án</a></li>
            <li class="dropdown">
              <a href="#" class="active"
                ><span>Blog</span>
                <i class="bi bi-chevron-down toggle-dropdown"></i
              ></a>
              <ul>
                <li><a href="java-co-ban.html">Java Cơ Bản</a></li>
                <li><a href="java-oop.html">Java OOP</a></li>
                <li><a href="java-spring.html">Java Spring Framework</a></li>
                <li><a href="java-collections.html">Java Collections</a></li>
                <li><a href="javascript-co-ban.html">JavaScript Cơ Bản</a></li>
                <li>
                  <a href="javascript-dom.html" class="active"
                    >JavaScript DOM</a
                  >
                </li>
                <li><a href="javascript-async.html">JavaScript Async</a></li>
                <li><a href="javascript-es6.html">JavaScript ES6+</a></li>
                <li>
                  <a href="java-javascript-tips.html">Java & JavaScript Tips</a>
                </li>
              </ul>
            </li>
            <li><a href="../contact.html">Liên Hệ</a></li>
          </ul>
          <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
        </nav>
      </div>
    </header>

    <div class="blog-post">
      <div class="container">
        <div class="blog-article">
          <div class="blog-header">
            <span class="blog-category">JavaScript</span>
            <h1 class="blog-title">JavaScript DOM - Khi Web "Sống" Dậy</h1>
            <div class="blog-meta">
              <span>6 tháng 10, 2025</span>
              <span>Nguyễn Tiến Dũng</span>
            </div>
          </div>
          <div class="blog-content">
            <h2>Lần đầu "sờ" vào DOM</h2>
            <p>
              Tuần đầu học JavaScript, tôi chỉ console.log trong browser. Đến
              khi mentor show tôi document.getElementById() và thay đổi
              innerHTML, tôi như được mở mang tầm mắt! "HTML có thể thay đổi
              được à?" - đó là suy nghĩ ngây thơ lúc đó.
            </p>

            <h2>getElementById vs querySelector - Cuộc chiến đầu tiên</h2>
            <p>
              Ban đầu tôi chỉ biết getElementById. Khi biết querySelector, tôi
              nghĩ "Wow, CSS selector mà!" Từ đó chỉ dùng querySelector cho mọi
              thứ. Sau này mới biết getElementById nhanh hơn cho single element.
            </p>

            <h2>Event Listeners - Phép màu tương tác</h2>
            <p>
              Lần đầu viết click event, tôi thấy như phù thủy! Click button →
              console.log('Hello'). Simple nhưng magical! Rồi từ đó tôi "nghiện"
              làm interactive elements: hover effects, form validation, modal
              popups...
            </p>

            <h2>Event Delegation - Revelation moment</h2>
            <p>
              Khi có 100 buttons cần event listener, tôi viết 100
              addEventListener. Performance tệ! Mentor dạy event delegation -
              attach listener lên parent và check event.target. Mind blown với
              event bubbling!
            </p>

            <h2>Những bug kinh điển với DOM</h2>
            <ul>
              <li>
                <strong>Script chạy trước HTML load:</strong> querySelector
                return null
              </li>
              <li>
                <strong>Quên preventDefault():</strong> Form submit làm page
                refresh
              </li>
              <li><strong>Memory leaks:</strong> Không removeEventListener</li>
              <li>
                <strong>NodeList vs Array:</strong> Không có map(), filter()
              </li>
            </ul>

            <h2>DOM Manipulation patterns tôi hay dùng</h2>
            <ul>
              <li>
                <strong>Toggle classes:</strong>
                element.classList.toggle('active')
              </li>
              <li>
                <strong>Create elements:</strong> createElement + appendChild
              </li>
              <li>
                <strong>Form handling:</strong> FormData API cho modern forms
              </li>
              <li>
                <strong>Dataset attributes:</strong> data-* attributes để store
                info
              </li>
            </ul>

            <h2>Performance lessons đắt giá</h2>
            <p>
              Project đầu tiên của tôi có 1000 DOM nodes và update liên tục. Lag
              kinh khủng! Học được: batch DOM updates, use DocumentFragment,
              cache selectors, avoid innerHTML trong loops.
            </p>

            <h2>Modern DOM APIs tôi yêu thích</h2>
            <ul>
              <li>
                <strong>Intersection Observer:</strong> Lazy loading images
              </li>
              <li><strong>MutationObserver:</strong> Watch DOM changes</li>
              <li><strong>ResizeObserver:</strong> Responsive components</li>
              <li><strong>Web Components:</strong> Custom elements</li>
            </ul>

            <h2>Virtual DOM - Tại sao React ra đời</h2>
            <p>
              Sau khi struggle với DOM manipulation performance, tôi hiểu tại
              sao React tạo Virtual DOM. Direct DOM manipulation expensive,
              React diff và update optimally. Lesson: hiểu problem trước khi học
              solution!
            </p>

            <h2>Tips DOM manipulation hiệu quả</h2>
            <ul>
              <li>
                <strong>Cache selectors:</strong> const btn =
                document.querySelector()
              </li>
              <li><strong>Use event delegation:</strong> Ít listeners hơn</li>
              <li>
                <strong>Batch updates:</strong> DocumentFragment hoặc innerHTML
              </li>
              <li>
                <strong>Avoid layout thrashing:</strong> Read properties trước,
                write sau
              </li>
              <li><strong>Use CSS transforms:</strong> Thay vì top/left</li>
            </ul>

            <h2>Kết luận</h2>
            <p>
              DOM manipulation là skill cốt lõi của frontend dev. Dù có
              React/Vue, hiểu DOM vẫn quan trọng. Từ getElementById đầu tiên đến
              Web Components, hành trình DOM đã dạy tôi cách tương tác với web
              theo cách sâu sắc nhất!
            </p>

            <div class="back-to-home"><a href="../index.html">← Về trang chủ</a></div>
          </div>

          <!-- Rating Section -->
          <div class="rating-section">
            <div class="rating-header">
              <h3>Đánh Giá Bài Viết</h3>
              <p>Bài viết này có hữu ích với bạn không?</p>
            </div>

            <div class="rating-stats">
              <div class="average-rating">
                <div class="rating-number">4.5</div>
                <div class="rating-stars-display">
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-half"></i>
                </div>
                <div class="rating-count">dựa trên 33 đánh giá</div>
              </div>

              <div class="rating-bars">
                <div class="rating-bar">
                  <span class="star-label">5★</span>
                  <div class="bar-container">
                    <div class="bar-fill" style="width: 64%"></div>
                  </div>
                  <span class="bar-count">21</span>
                </div>
                <div class="rating-bar">
                  <span class="star-label">4★</span>
                  <div class="bar-container">
                    <div class="bar-fill" style="width: 27%"></div>
                  </div>
                  <span class="bar-count">9</span>
                </div>
                <div class="rating-bar">
                  <span class="star-label">3★</span>
                  <div class="bar-container">
                    <div class="bar-fill" style="width: 9%"></div>
                  </div>
                  <span class="bar-count">3</span>
                </div>
                <div class="rating-bar">
                  <span class="star-label">2★</span>
                  <div class="bar-container">
                    <div class="bar-fill" style="width: 0%"></div>
                  </div>
                  <span class="bar-count">0</span>
                </div>
                <div class="rating-bar">
                  <span class="star-label">1★</span>
                  <div class="bar-container">
                    <div class="bar-fill" style="width: 0%"></div>
                  </div>
                  <span class="bar-count">0</span>
                </div>
              </div>
            </div>

            <div class="rate-article">
              <h4>Đánh giá bài viết này</h4>
              <div class="star-rating" id="userRating">
                <span class="star" data-rating="1">★</span>
                <span class="star" data-rating="2">★</span>
                <span class="star" data-rating="3">★</span>
                <span class="star" data-rating="4">★</span>
                <span class="star" data-rating="5">★</span>
              </div>
              <button class="rate-button" id="submitRating" disabled>
                Gửi Đánh Giá
              </button>
              <div
                class="rating-message"
                id="ratingMessage"
                style="display: none"
              ></div>
            </div>
          </div>

          <!-- Comments Section -->
          <div class="comments-section">
            <div class="comments-header">
              <h3>
                <i class="bi bi-chat-dots"></i>
                Bình Luận
                <span class="comments-count">19</span>
              </h3>
              <p>Chia sẻ suy nghĩ và kinh nghiệm của bạn</p>
            </div>

            <!-- Comment Form -->
            <div class="comment-form">
              <h4>Để lại bình luận</h4>
              <form id="commentForm">
                <div class="form-row">
                  <div class="form-group">
                    <label for="commentName">Họ Tên *</label>
                    <input type="text" id="commentName" name="name" required />
                  </div>
                  <div class="form-group">
                    <label for="commentEmail">Email *</label>
                    <input
                      type="email"
                      id="commentEmail"
                      name="email"
                      required
                    />
                  </div>
                </div>
                <div class="form-group">
                  <label for="commentContent">Bình Luận *</label>
                  <textarea
                    id="commentContent"
                    name="content"
                    placeholder="Chia sẻ suy nghĩ của bạn về bài viết..."
                    required
                  ></textarea>
                </div>
                <button type="submit" class="submit-comment">
                  Gửi Bình Luận
                </button>
              </form>
            </div>

            <!-- Comments List -->
            <div class="comments-list">
              <!-- Sample Comment 1 -->
              <div class="comment">
                <div class="comment-header">
                  <div class="comment-author">
                    <div class="author-avatar">V</div>
                    <div class="author-info">
                      <h5>Văn Khoa</h5>
                      <span class="comment-date">1 ngày trước</span>
                    </div>
                  </div>
                </div>
                <div class="comment-content">
                  <p>
                    Performance tips về DOM manipulation cực hữu ích! Mình áp
                    dụng event delegation và thấy app smooth hơn hẳn.
                  </p>
                </div>
                <div class="comment-actions">
                  <button class="comment-action like-btn">
                    <i class="bi bi-heart"></i>
                    <span class="like-count">8</span>
                  </button>
                  <button class="comment-action reply-btn">
                    <i class="bi bi-reply"></i>
                    Trả lời
                  </button>
                </div>
              </div>

              <!-- Sample Comment 2 -->
              <div class="comment">
                <div class="comment-header">
                  <div class="comment-author">
                    <div class="author-avatar">P</div>
                    <div class="author-info">
                      <h5>Phong Lê</h5>
                      <span class="comment-date">4 ngày trước</span>
                    </div>
                  </div>
                </div>
                <div class="comment-content">
                  <p>
                    Modern DOM APIs như Intersection Observer và
                    MutationObserver mình chưa biết! Cảm ơn bạn đã chia sẻ, sẽ
                    research thêm.
                  </p>
                </div>
                <div class="comment-actions">
                  <button class="comment-action like-btn">
                    <i class="bi bi-heart"></i>
                    <span class="like-count">6</span>
                  </button>
                  <button class="comment-action reply-btn">
                    <i class="bi bi-reply"></i>
                    Trả lời
                  </button>
                </div>
              </div>
            </div>

            <!-- Load More Comments -->
            <div class="load-more-comments">
              <button class="load-more-btn">Xem Thêm Bình Luận</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer id="footer" class="footer light-background">
      <div class="container">
        <div class="copyright text-center">
          <p>
            © <span>Copyright</span>
            <strong class="px-1 sitename">Nguyễn Tiến Dũng</strong>
            <span>All Rights Reserved</span>
          </p>
        </div>
      </div>
    </footer>

    <a
      href="#"
      id="scroll-top"
      class="scroll-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

    <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/main.js"></script>

    <script>
      // Rating System
      const stars = document.querySelectorAll(".star");
      const submitRatingBtn = document.getElementById("submitRating");
      const ratingMessage = document.getElementById("ratingMessage");
      let selectedRating = 0;

      stars.forEach((star) => {
        star.addEventListener("mouseover", () => {
          const rating = parseInt(star.dataset.rating);
          highlightStars(rating);
        });

        star.addEventListener("mouseout", () => {
          highlightStars(selectedRating);
        });

        star.addEventListener("click", () => {
          selectedRating = parseInt(star.dataset.rating);
          highlightStars(selectedRating);
          submitRatingBtn.disabled = false;
        });
      });

      function highlightStars(rating) {
        stars.forEach((star, index) => {
          if (index < rating) {
            star.classList.add("active");
          } else {
            star.classList.remove("active");
          }
        });
      }

      submitRatingBtn.addEventListener("click", () => {
        if (selectedRating > 0) {
          submitRatingBtn.disabled = true;
          submitRatingBtn.textContent = "Đang gửi...";

          setTimeout(() => {
            ratingMessage.style.display = "block";
            ratingMessage.className = "rating-message success";
            ratingMessage.textContent = `Cảm ơn bạn đã đánh giá ${selectedRating} sao! Đánh giá của bạn đã được ghi nhận.`;
            submitRatingBtn.textContent = "Đã gửi";
          }, 1000);
        }
      });

      // Comments System
      const commentForm = document.getElementById("commentForm");
      const commentsList = document.querySelector(".comments-list");
      const commentsCount = document.querySelector(".comments-count");

      commentForm.addEventListener("submit", (e) => {
        e.preventDefault();

        const name = document.getElementById("commentName").value;
        const email = document.getElementById("commentEmail").value;
        const content = document.getElementById("commentContent").value;

        if (name && email && content) {
          addComment(name, content);
          commentForm.reset();
        }
      });

      function addComment(name, content) {
        const newComment = document.createElement("div");
        newComment.className = "comment";

        const avatar = name.charAt(0).toUpperCase();
        const currentTime = "vừa xong";

        newComment.innerHTML = `
          <div class="comment-header">
            <div class="comment-author">
              <div class="author-avatar">${avatar}</div>
              <div class="author-info">
                <h5>${name}</h5>
                <span class="comment-date">${currentTime}</span>
              </div>
            </div>
          </div>
          <div class="comment-content">
            <p>${content}</p>
          </div>
          <div class="comment-actions">
            <button class="comment-action like-btn">
              <i class="bi bi-heart"></i>
              <span class="like-count">0</span>
            </button>
            <button class="comment-action reply-btn">
              <i class="bi bi-reply"></i>
              Trả lời
            </button>
          </div>
        `;

        commentsList.insertBefore(newComment, commentsList.firstChild);

        const currentCount = parseInt(commentsCount.textContent);
        commentsCount.textContent = currentCount + 1;

        const likeBtn = newComment.querySelector(".like-btn");
        addLikeFunctionality(likeBtn);

        newComment.scrollIntoView({ behavior: "smooth", block: "center" });
      }

      // Like functionality
      function addLikeFunctionality(likeBtn) {
        likeBtn.addEventListener("click", () => {
          const likeCount = likeBtn.querySelector(".like-count");
          const currentLikes = parseInt(likeCount.textContent);
          const heart = likeBtn.querySelector("i");

          if (heart.classList.contains("bi-heart")) {
            heart.classList.remove("bi-heart");
            heart.classList.add("bi-heart-fill");
            likeCount.textContent = currentLikes + 1;
            likeBtn.style.color = "#e74c3c";
          } else {
            heart.classList.remove("bi-heart-fill");
            heart.classList.add("bi-heart");
            likeCount.textContent = currentLikes - 1;
            likeBtn.style.color = "";
          }
        });
      }

      // Add like functionality to existing comments
      document.querySelectorAll(".like-btn").forEach(addLikeFunctionality);

      // Reply functionality
      document.querySelectorAll(".reply-btn").forEach((replyBtn) => {
        replyBtn.addEventListener("click", () => {
          alert("Chức năng trả lời đang được phát triển!");
        });
      });

      // Load more comments
      document.querySelector(".load-more-btn").addEventListener("click", () => {
        alert("Đã hiển thị tất cả bình luận!");
      });
    </script>
  </body>
</html>
